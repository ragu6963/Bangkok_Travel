{% extends 'base.html' %}
{% load static %}

{% block head %}
{# google map Api 설정 스크립트 #}
<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
{# map script 컴포넌트 #}
{% include 'posts/map.html' with lat=post.lat lng=post.lng heading=post.heading pitch=post.pitch  %}
<link rel="stylesheet" href="{% static 'css/map.css' %}">
<link rel="stylesheet" href="{% static 'posts/css/detail.css' %}">
{% endblock head %}

{% block content %}
<div class='container'>
  {# 제목 #}
  <div class="mb-3">
    <p class="fw-bolder fs-1">{{ post.title }}</p>
  </div>
  {# 수정 삭제 버튼 #}
  {% if post.user == user %}
  <div class="d-flex justify-content-end gap-2 mb-3">
    <a class="text-decoration-none text-muted fs-7" href="{% url 'posts:update' post.id %}">수정</a>
    <a class="text-decoration-none text-muted fs-7" href="#" data-bs-toggle="modal" data-bs-target="#deleteModal">삭제</a>
  </div>
  {% include "posts/delete.html" %}
  {% endif %}

  {# 글쓴이 최근 수정날짜 #}
  <div class="d-flex mb-3 align-items-center gap-1">
    <span class="fw-bold fs-7 d-inline">
      <a class="text-decoration-none text-dark fw-bold" href="">{{ post.user }}</a>
    </span>
    <span>
      ·
    </span>
    <span class="text-decoration-none fs-7">
      {{ post.updated_at | date:"Y년 M d일 H:m" }}
    </span>
  </div>

  <div class="d-flex justify-content-center mb-5">
    <div class="map" id="map"></div>
  </div>
  <div class="mb-5">
    {{ post.content|safe }}
  </div>
  <div class="mb-3">
    <form action="{% url 'posts:comment_create' post.pk %}" method="POST">
      {% csrf_token %}
      {{ commentform.as_p }}
      <button class="d-block ms-auto bttn-material-flat bttn-sm bttn-success">댓글 작성</button>
    </form>
  </div>
  {% for comment in comments %}
  <div class="d-flex flex-column mb-4">
    <div class="d-flex flex-column fs-7 mb-2">
      <div class="fw-bold">{{ comment.user }}</div>
      <div class="text-secondary">{{ comment.created_at|date:"Y년 m월 d일" }}</div>
    </div>
    <div class="fs-5">
      {{ comment.content }}
    </div>
    <hr>
  </div>
  {% endfor %}




  {% include "api_key.html" with MAPS_API_KEY=MAPS_API_KEY %}
</div>
{% endblock content %}